<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Painel Controle</title>
<style>
body { font-family: Arial; background:#111; color:#fff; padding:20px; }
input, button { margin:5px; padding:8px; }
ul { list-style:none; padding-left:0; }
li { padding:3px 0; }
</style>
</head>
<body>
<h1>Painel de Controle</h1>

<h3>Enviar URL</h3>
<input type="text" id="url" placeholder="Digite o link aqui" size="40">
<button onclick="enviarUrl()">Enviar URL</button>

<hr>

<h3>Conectados</h3>
<ul id="listaConectados"></ul>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey:"AIzaSyCCz1Z1pg95O0NER7_IRKoJ0mDqPgWaW-o",
  databaseURL:"https://painel-caos-default-rtdb.firebaseio.com"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Envia URL para o bookmarklet
function enviarUrl(){
  let url = document.getElementById("url").value.trim();
  if(!url) return;

  // Adiciona https:// se necessÃ¡rio
  if(!url.startsWith("http://") && !url.startsWith("https://")){
    url = "https://" + url;
  }

  db.ref("comando").set(url);
  alert("URL enviada!");
}

// Lista de conectados
const lista = document.getElementById("listaConectados");
db.ref("conectados").on("value", snap => {
  lista.innerHTML = "";
  snap.forEach(userSnap => {
    const li = document.createElement("li");
    li.textContent = userSnap.key;
    lista.appendChild(li);
  });
});
</script>
</body>
</html>
